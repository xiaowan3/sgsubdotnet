#summary SGSUB.Net 时间轴教程
#labels Featured

<wiki:toc max_depth="2" />

= 准备工作 =

时间轴的工作是把翻译好的字幕和视频中人物说话的时间对齐。以制作中文字幕为例。在开始工作时，你的手头应该有一份翻译好的文本，和没字幕的片源。翻译的文本通常为TXT格式的纯文本，一行一句话。片源的话，肯定是你机器能放的。


= 开始打轴 =

点击 文件->打开视频 打开片源，用 文件->打开翻译文本 打开你的TXT文件。
<img src="http://sgsubdotnet.googlecode.com/svn/wiki/imgs/timing00.png"/>

现在你就可以开始打轴了。选中第一行的某个单元格，一边播放视频一边用耳朵听。开始说话时按下A键，说完了松开A键。按下A键盘时，设置这一行的开始时间，松开时设置结束时间。设置结束时间之后选中的单元格会自动移到下一行的开始时间上，于是可以接着设置第二行的开始和结束时间。
字幕会显示在文本的上方的空白处，必要时你可以后退，检查你设置的开始和结束时间是否合适。

<img src="http://sgsubdotnet.googlecode.com/svn/wiki/imgs/timing01.png"/>

= 播放快捷键 =

在播放时，你可以使用这些快捷键来控制播放器。如果不习惯默认按键，可以在按键设置中修改。

 * Q 后退3秒
 * W 前进3秒
 * E 跳至当前行的开始时间
 * R 跳至上一行的开始时间
 * 空格 暂停/播放

= 其它的时间按键 =
SGSUB.Net支持多种设置开始和结束时间的方式，如果你不喜上面说的那种，可以选择其它的按键。

 * 按行设置时间：A。按下时设置开始时间，松开时设置结束时间，自动跳至下一行。
 * 按单元格设置时间：S。按下时设置当前单元格的时间，并自动跳至下一个单元格。
 * 连续设置时间：D。按下按键时设置当前行的结束时间和下一行的开始时间，自动跳至下一行。
 * 设置开始时间：Z。按下时设置当前行的开始时间，并选中当前行结束时间的单元格。
 * 设置结束时间：X。按下时设置当前行的结束时间，并选中下一行开始时间的单元格。

微调时间轴：
 * O：选中单元格的时间提前200ms。
 * P：选中单元格的时间推迟200ms。
 
= 用频谱打轴 =
按下<img src="http://sgsubdotnet.googlecode.com/svn/wiki/imgs/initfft.png"/>可以读取音频频谱，读取频谱的时间有点长，请耐心等一会儿。用频谱辅助打轴，不仅能提高，也能提高效率。

== 认识频谱 ==
<img src="http://sgsubdotnet.googlecode.com/svn/wiki/imgs/timing02.png"/>

频谱图是音频信号经过离散余弦变换得到的，横轴是时间，纵轴是频率，颜色越亮表示信号越强。图中的那条红线指示当前播放的位置，频谱图随着视频的播放而滚动。当人物说话时，在频谱图上就会以曲线形式表示出来。通常人声和背景的声音频率多少会有一些差异，所以可以通过观察频谱图，把人声和背景声音区分出来。

从下面的这个图中就可以看出，人声的频谱的一些曲线，而背景声音相对更不规则一些。再多多观察和练习，就可以通过频谱图找出人声了。

<img src="http://sgsubdotnet.googlecode.com/svn/wiki/imgs/timing03.png"/>

== 用频谱打轴 ==
可以一边播放一边观察频谱，注意一句话开始和结束的位置。每说完一句话按空格暂停，然后用鼠在频谱图上点取当前一句的开始时间和结束时间。单击鼠标左键设置的是开始时间，单击右键设置结束时间。设置结束时间之后，会自动跳到下一行。一般，开始时间需要略早于曲线出现的位置，有时，字幕结束的时间要酌情延后。由于[s] [h]等辅音开始的特征不明显，因此“さ”“は”等行的假名开头的句子，在频谱图上的提前量要加略大一些。只要多多练习，多多后退检查，熟练之后就可以做得又准又快了。

频谱图下面是上一行、当前行和下一行的文字，可以不用一边看频谱，一边看文本的表格。文字后面的时间是该行的持续时间，主要是为了避免持续时间过短的字幕。在频谱图上，上一行的时间段用紫色表示，当前行的时间段用绿色表示。如果两句时间轴有重叠，从频谱图上就可以看出来。

<img src="http://sgsubdotnet.googlecode.com/svn/wiki/imgs/timing04.png"/>

= 时间轴调整 =

包括微调时间轴和时间平移。

== 微调时间轴 ==

按O键和P键可以让当前单元格的时间提前或推迟0.2s。

== 时间平移 ==

选中要平移的单元格，单击<img src="http://sgsubdotnet.googlecode.com/svn/wiki/imgs/markcell.png"/>对单元格进行标记。标记之后的单元格景色会变成淡蓝色。

<img src="http://sgsubdotnet.googlecode.com/svn/wiki/imgs/timing05.png"/>

点击<img src="http://sgsubdotnet.googlecode.com/svn/wiki/imgs/timeoffset.png"/>，并在对话框中输入平移的量。

<img src="http://sgsubdotnet.googlecode.com/svn/wiki/imgs/timing06.png"/>

点击OK，就好了，然后点击<img src="http://sgsubdotnet.googlecode.com/svn/wiki/imgs/unmarkall.png"/>清除标记。

<img src="http://sgsubdotnet.googlecode.com/svn/wiki/imgs/timing07.png"/>

== 检查时间轴 ==

点击<img src="http://sgsubdotnet.googlecode.com/svn/wiki/imgs/timelinecheck.png"/>检查时间轴有没有重叠或时间错误（结束时间小于开始时间）。

如果发现时间轴重叠，重叠部分会显示成红色。如果发现有某行的结束时间小于开始时间，这一行的时间会显示成蓝色。

<img src="http://sgsubdotnet.googlecode.com/svn/wiki/imgs/timing08.png"/>

= 相关参数设置 =

点击“设置->按键设置”可以设置打轴的按键还有前进、后退步长，反应时间，微调步长等参数。在“设置->自定义”可以选择界面布局，设置自动保存参数，选择播放器。

== 反应时间和自动重叠修正 ==

由于人在按键时有少量的延时，所以按键的时间通常会落后句子的开始或结束时间。因此每一行字幕的开始和结束时间要在实际按键的时间上加一个时间差，这就是反应时间。由于字幕的时间要略早于按键的时间，所以反应时间一般是负值。

当前后两句话中间间隔时间很短时，如果开反应时间小于终止反应时间，就有可能出现加上反应时间之后，后一句的开始时间早于前一句的结束时间。为了避免这种情况，就有了自动重叠修正的功能。如果在设置一句的开始时间，这个时间如果略早于上一句的结束时间，就会自动用这一句的开始时间去修正上一句的结束时间，避免时间轴重叠。

<img src="http://sgsubdotnet.googlecode.com/svn/wiki/imgs/keycfg.png"/>

== 布局选择 ==

点击“设置->自定义”，在布局管理中可以选择布局。更换布局后，需要重启此程序。

== 播放器的选择 ==

点击“设置->自定义”，在参数设置中可以选择播放时所用的播放器。更换播放器之后,要重启此程序。

 * DShow播放器 基于 Direct Show 的播放器，如果机器上安装解码器的话，常见的视频都能放。支持单帧步进。
 * MDX播放器 也是基于 Direct Show 的，只是用Managed DirectX写的，不支持单帧步进。
 * WMP播放器 Windows Media Player控件，稳定性不错，在XP下装了解码器就能放大部分格式，但在Win7下比较废。不支持单帧步进。
 * MPlayer播放器 使用开源的MPlayer做播放器，稳定性不太好，能播放大部分格式的视频并且不依赖本机的解码器。如果因为安装了QQ影音或迅雷看看之因的软件导致机器上的DShow解码器工作不正常的话，可以试试这个。支持单帧步进，但MPlayer不能精确地seek，所以在前进或后退时可能有点不爽。